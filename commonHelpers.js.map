{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '39338997-3d04d1d59a8e2d0c329000ae7';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchPhotosByQuery(query, page = 1) {\n  const searchParams = new URLSearchParams({\n    q: query,\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page,\n  });\n  try {\n    const { data } = await axios(`${BASE_URL}?${searchParams}`);\n\n    return data;\n  } catch (error) {\n    iziToast.error({\n      message: 'Sorry, something went wrong!',\n    });\n  }\n}\n","export const createGalleryItemMarkup = images => {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      \n        <li class=\"card\">\n        <a href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-img\" />\n          <div class=\"card-body\">\n            <div class=\"d-flex \">\n              \n              <p class=\"text\">Likes: ${likes}</p>\n              <p class=\"text\">Views: ${views}</p>\n              <p class=\"text\">Comments: ${comments}</p>\n              <p class=\"text\">Downloads: ${downloads}</p>\n            </div>\n          </div>\n          </a>\n        </li>\n      `\n    )\n    .join('');\n};\n","import { fetchPhotosByQuery } from './js/pixabay-api';\n\nimport iziToast from 'izitoast';\n\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { createGalleryItemMarkup } from './js/render-functions';\n\nimport SimpleLightbox from 'simplelightbox';\n\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n});\nconst loader = document.querySelector('.loader');\nconst formSearch = document.querySelector('.js-search-form');\nconst galleryList = document.querySelector('.gallery');\nconst loadBtn = document.querySelector('.load-btn');\nlet totalPages = 0;\nloadBtn.style.display = 'none';\nlet page = 1;\nlet searchQuery = '';\nformSearch.addEventListener('submit', searchPhotos);\nasync function searchPhotos(event) {\n  event.preventDefault();\n  searchQuery = formSearch.elements.searchQuery.value.trim();\n  galleryList.innerHTML = '';\n  loadBtn.style.display = 'none';\n  page = 1;\n  if (searchQuery === '') {\n    iziToast.warning({ message: 'Enter something for search!' });\n    return;\n  }\n  loader.style.display = 'block';\n  try {\n    const data = await fetchPhotosByQuery(searchQuery);\n    if (data.hits.length === 0) {\n      iziToast.warning({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n    const markup = createGalleryItemMarkup(data.hits);\n    galleryList.insertAdjacentHTML('beforeend', markup);\n\n    lightbox.refresh();\n    totalPages = Math.ceil(data.totalHits / 15);\n    if (data.totalHits > 15) {\n      loadBtn.style.display = 'block';\n    }\n  } catch (error) {\n    iziToast.error({\n      message: 'Sorry, something went wrong!',\n    });\n  } finally {\n    loader.style.display = 'none';\n    formSearch.reset();\n  }\n}\nsetTimeout(() => (loader.style.display = 'none'), 500);\nloadBtn.addEventListener('click', onLoadMore);\nasync function onLoadMore() {\n  page += 1;\n\n  loader.style.display = 'block';\n  try {\n    const data = await fetchPhotosByQuery(searchQuery, page);\n\n    const markup = createGalleryItemMarkup(data.hits);\n    galleryList.insertAdjacentHTML('beforeend', markup);\n    smoothScrollOnLoadMore();\n    lightbox.refresh();\n    if (page === totalPages) {\n      loadBtn.style.display = 'none';\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      message: 'Sorry, something went wrong!',\n    });\n  } finally {\n    loader.style.display = 'none';\n  }\n}\nfunction smoothScrollOnLoadMore() {\n  const lastCard = galleryList.querySelector('.card');\n  const cardHeight = lastCard.getBoundingClientRect().height;\n  const scrollHeight = cardHeight * 2;\n\n  window.scrollBy({\n    top: scrollHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n"],"names":["API_KEY","BASE_URL","fetchPhotosByQuery","query","page","searchParams","data","axios","createGalleryItemMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","loader","formSearch","galleryList","loadBtn","totalPages","searchQuery","searchPhotos","event","iziToast","markup","onLoadMore","smoothScrollOnLoadMore","scrollHeight"],"mappings":"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"}